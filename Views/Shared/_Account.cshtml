@{
    Layout = null;
    ViewData["Title"] ??= "Dashboard";
}

<!DOCTYPE html>
<html lang="en" class="h-full bg-white dark:bg-black">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>@ViewData["Title"]</title>

    <!-- Tailwind (CDN) -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: { brandYellow: "#F9D900" }
                }
            }
        };

        // Apply saved theme before paint (avoid flash)
        (() => {
            const saved = localStorage.getItem("theme");
            const prefersDark = window.matchMedia("(prefers-color-scheme: dark)").matches;
            if (saved === "dark" || (!saved && prefersDark)) {
                document.documentElement.classList.add("dark");
            }
        })();
    </script>

    @RenderSection("Head", required: false)
</head>

<body class="h-full text-slate-900 dark:text-slate-50">

    <!-- ===================== TOP NAVBAR ===================== -->
    <header
        class="sticky top-0 z-50 w-full border-b border-slate-200 bg-white/95 backdrop-blur dark:border-slate-800 dark:bg-black">
        <nav class="mx-auto flex h-16 w-full max-w-full items-center justify-between px-4 sm:px-6">

            <!-- LEFT: mobile close (only when sidebar open) + logo -->
            <div class="flex items-center gap-3">
                <!-- MOBILE CLOSE (TOP LEFT) -->
                <button id="sidebarClose" class="hidden md:hidden h-9 w-9 items-center justify-center rounded-full border border-slate-300 bg-white text-slate-600 hover:bg-slate-100
                               dark:border-slate-700 dark:bg-black dark:text-slate-200 dark:hover:bg-slate-900"
                    aria-label="Close menu">
                    <svg viewBox="0 0 24 24" class="h-4 w-4" fill="none" stroke="currentColor" stroke-width="2"
                        stroke-linecap="round" stroke-linejoin="round">
                        <path d="M6 6l12 12M18 6L6 18" />
                    </svg>
                </button>

                <a asp-controller="Account" asp-action="Index" class="flex items-center gap-2">
                    <span
                        class="text-xl sm:text-2xl font-bold tracking-tight text-slate-900 dark:text-white">TradingNintyOne</span>
                </a>
            </div>

            <!-- RIGHT: actions -->
            <div class="flex items-center gap-2 sm:gap-3">

                <!-- Notifications dropdown -->
                <div class="relative" data-dropdown-root>
                    <button type="button" class="inline-flex h-9 w-9 items-center justify-center rounded-full border border-slate-200 bg-white text-slate-600 hover:bg-slate-100
                                   dark:border-slate-700 dark:bg-black dark:text-slate-200 dark:hover:bg-slate-900"
                        data-dropdown-btn="notifications" aria-label="Open notifications">
                        <svg class="h-5 w-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.9"
                            stroke-linecap="round" stroke-linejoin="round">
                            <path d="M12 5a4 4 0 0 0-4 4v3.5L7 15h10l-1-2.5V9a4 4 0 0 0-4-4z" />
                            <path d="M10 17a2 2 0 0 0 4 0" />
                        </svg>
                    </button>

                    <div data-dropdown-panel="notifications" class="hidden absolute right-0 mt-2 w-80 rounded-xl border border-slate-200 bg-white shadow-xl
                                dark:border-slate-700 dark:bg-slate-950">
                        <div
                            class="flex items-center justify-between border-b border-slate-100 px-4 py-3 dark:border-slate-800">
                            <span class="text-sm font-semibold text-slate-900 dark:text-slate-50">Notifications</span>
                            <button
                                class="text-xs text-slate-500 hover:text-slate-700 dark:text-slate-400 dark:hover:text-slate-200">
                                Mark all as read
                            </button>
                        </div>
                        <div class="max-h-64 space-y-1 overflow-y-auto px-2 py-2 text-sm">
                            <div
                                class="rounded-lg px-3 py-2 text-slate-700 hover:bg-slate-50 dark:text-slate-200 dark:hover:bg-slate-900/80">
                                No new notifications
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Dark / Light toggle -->
                <button id="modeToggle" class="inline-flex h-9 w-9 items-center justify-center rounded-full border border-slate-200 bg-white text-slate-700 hover:bg-slate-100
                               dark:border-slate-700 dark:bg-black dark:text-slate-100 dark:hover:bg-slate-900"
                    aria-label="Toggle dark mode">
                    <svg id="sunIcon" class="h-5 w-5 block dark:hidden" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="2" stroke-linecap="round">
                        <circle cx="12" cy="12" r="4" />
                        <path
                            d="M12 2v2M12 20v2M4.93 4.93 6.34 6.34M17.66 17.66 19.07 19.07M2 12h2M20 12h2M4.93 19.07 6.34 17.66M17.66 6.34 19.07 4.93" />
                    </svg>
                    <svg id="moonIcon" class="hidden h-5 w-5 dark:block" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="2" stroke-linecap="round">
                        <path d="M21 12.79A9 9 0 0 1 11.21 3 7 7 0 1 0 21 12.79z" />
                    </svg>
                </button>

                <!-- Profile dropdown: DESKTOP ONLY -->
                <div class="relative hidden md:block" data-dropdown-root>
                    <button type="button" data-dropdown-btn="profile" class="inline-flex h-10 w-10 items-center justify-center rounded-full bg-slate-900 text-sm font-semibold text-white
                                   hover:bg-slate-800 dark:bg-slate-100 dark:text-slate-900 dark:hover:bg-slate-300">
                        b
                    </button>

                    <div data-dropdown-panel="profile" class="hidden absolute right-0 mt-2 w-56 rounded-xl border border-slate-200 bg-white shadow-xl
                                dark:border-slate-700 dark:bg-slate-950">
                        <div class="border-b border-slate-100 px-4 py-3 dark:border-slate-800">
                            <p class="text-sm font-semibold text-slate-900 dark:text-slate-50">benson</p>
                            <p class="text-xs text-slate-500 dark:text-slate-400">benson@example.com</p>
                        </div>
                        <div class="py-2 text-sm">
                            <a href="#"
                                class="block px-4 py-2 text-slate-700 hover:bg-slate-50 dark:text-slate-200 dark:hover:bg-slate-900/80">
                                Profile &amp; security
                            </a>
                            <a href="#"
                                class="block px-4 py-2 text-slate-700 hover:bg-slate-50 dark:text-slate-200 dark:hover:bg-slate-900/80">
                                Settings
                            </a>
                            <div class="my-1 border-t border-slate-100 dark:border-slate-800"></div>
                            <a href="#"
                                class="block px-4 py-2 text-red-600 hover:bg-red-50 dark:text-red-400 dark:hover:bg-red-950/40">
                                Log out
                            </a>
                        </div>
                    </div>
                </div>

            </div>
        </nav>
    </header>

    <!-- ===================== MAIN LAYOUT ===================== -->
    <div class="flex h-[calc(100vh-64px)] overflow-hidden">

        <!-- ========== SIDEBAR (drawer on mobile, static on desktop) ========== -->
        <aside id="sidebar"
            class="fixed inset-x-0 top-16 bottom-0 z-40 bg-white px-4 py-5 overflow-y-auto
                transform transition-transform duration-200 ease-out -translate-x-full
                dark:bg-black
                md:static md:inset-auto md:z-0 md:block md:w-72 md:border-r md:border-slate-200 md:dark:border-slate-800 md:transform-none md:translate-x-0">

            <nav aria-label="Main sidebar" class="flex h-full flex-col gap-3">

                <!-- Trading -->
                <div class="space-y-1">
                    <button type="button" class="group flex w-full items-center justify-between rounded-md border px-3 py-2 text-sm font-medium
                       border-slate-200 bg-slate-50 text-slate-900
                       hover:bg-slate-50 hover:border-slate-200
                       dark:border-slate-700 dark:bg-white/5 dark:text-slate-50 dark:hover:bg-white/10"
                        data-accordion-trigger data-target="#tradingMenu" aria-expanded="true">
                        <span class="flex items-center gap-3">
                            <span class="flex h-6 w-6 items-center justify-center rounded-full
                         text-slate-500 group-hover:text-slate-700
                         dark:text-slate-400 dark:group-hover:text-slate-200">
                                <svg viewBox="0 0 24 24" class="h-4 w-4" fill="none" stroke="currentColor"
                                    stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <path d="M6 4v16M6 8h4v8H6z" />
                                    <path d="M18 4v16M14 10h4v4h-4z" />
                                </svg>
                            </span>
                            <span>Trading</span>
                        </span>
                        <span class="ml-2 text-slate-400 transition-transform duration-150 group-hover:text-slate-500
                       dark:text-slate-500 dark:group-hover:text-slate-300" data-accordion-caret data-open="true">
                            <svg viewBox="0 0 20 20" class="h-4 w-4 -rotate-180" fill="none" stroke="currentColor"
                                stroke-width="1.8" stroke-linecap="round">
                                <path d="M6 8l4 4 4-4" />
                            </svg>
                        </span>
                    </button>

                    <ul id="tradingMenu" class="mt-1 space-y-1 pl-9" data-accordion-panel data-open="true">
                        <li>
                            <a href="#account" class="block rounded-md bg-slate-50 px-3 py-2 text-sm font-medium text-slate-900 hover:bg-slate-100
                      dark:bg-white/10 dark:text-slate-50 dark:hover:bg-white/15">
                                My accounts
                            </a>
                        </li>
                        <li>
                            <a href="#performance" class="block rounded-md px-3 py-2 text-sm text-slate-700 hover:bg-slate-50
                      dark:text-slate-200 dark:hover:bg-white/5">
                                Performance
                            </a>
                        </li>
                        <li>
                            <a href="#trade" class="block rounded-md px-3 py-2 text-sm text-slate-700 hover:bg-slate-50
                      dark:text-slate-200 dark:hover:bg-white/5">
                                History of orders
                            </a>
                        </li>
                    </ul>
                </div>

                <!-- Payments & wallet -->
                <div class="space-y-1">
                    <button type="button" class="group flex w-full items-center justify-between rounded-md border border-transparent px-3 py-2 text-sm font-medium
                       text-slate-800 hover:border-slate-200 hover:bg-slate-50
                       dark:text-slate-100 dark:hover:bg-white/10 dark:hover:border-slate-700" data-accordion-trigger
                        data-target="#paymentsMenu" aria-expanded="false">
                        <span class="flex items-center gap-3">
                            <span class="flex h-6 w-6 items-center justify-center rounded-full
                         text-slate-500 group-hover:text-slate-700
                         dark:text-slate-400 dark:group-hover:text-slate-200">
                                <svg viewBox="0 0 24 24" class="h-4 w-4" fill="none" stroke="currentColor"
                                    stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <rect x="3" y="6" width="18" height="12" rx="2" />
                                    <path d="M16 12h3" />
                                </svg>
                            </span>
                            <span>Payments &amp; wallet</span>
                        </span>
                        <span class="ml-2 text-slate-400 transition-transform duration-150 group-hover:text-slate-500
                       dark:text-slate-500 dark:group-hover:text-slate-300" data-accordion-caret>
                            <svg viewBox="0 0 20 20" class="h-4 w-4" fill="none" stroke="currentColor"
                                stroke-width="1.8" stroke-linecap="round">
                                <path d="M6 8l4 4 4-4" />
                            </svg>
                        </span>
                    </button>

                    <ul id="paymentsMenu" class="mt-1 hidden space-y-1 pl-9" data-accordion-panel data-open="false">
                        <li>
                            <a href="#account" class="block rounded-md px-3 py-2 text-sm text-slate-700 hover:bg-slate-50
                      dark:text-slate-200 dark:hover:bg-white/5">
                                Wallet overview
                            </a>
                        </li>
                        <li>
                            <a href="#trade" class="block rounded-md px-3 py-2 text-sm text-slate-700 hover:bg-slate-50
                      dark:text-slate-200 dark:hover:bg-white/5">
                                Deposit
                            </a>
                        </li>
                        <li>
                            <a href="#trade" class="block rounded-md px-3 py-2 text-sm text-slate-700 hover:bg-slate-50
                      dark:text-slate-200 dark:hover:bg-white/5">
                                Withdrawal
                            </a>
                        </li>
                    </ul>
                </div>

                <!-- Analytics -->
                <div class="space-y-1">
                    <button type="button" class="group flex w-full items-center justify-between rounded-md border border-transparent px-3 py-2 text-sm font-medium
                       text-slate-800 hover:border-slate-200 hover:bg-slate-50
                       dark:text-slate-100 dark:hover:bg-white/10 dark:hover:border-slate-700" data-accordion-trigger
                        data-target="#analyticsMenu" aria-expanded="false">
                        <span class="flex items-center gap-3">
                            <span class="flex h-6 w-6 items-center justify-center rounded-full
                         text-slate-500 group-hover:text-slate-700
                         dark:text-slate-400 dark:group-hover:text-slate-200">
                                <svg viewBox="0 0 24 24" class="h-4 w-4" fill="none" stroke="currentColor"
                                    stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <rect x="3" y="12" width="3" height="8" rx="1" />
                                    <rect x="10.5" y="8" width="3" height="12" rx="1" />
                                    <rect x="18" y="4" width="3" height="16" rx="1" />
                                </svg>
                            </span>
                            <span>Analytics</span>
                        </span>
                        <span class="ml-2 text-slate-400 transition-transform duration-150 group-hover:text-slate-500
                       dark:text-slate-500 dark:group-hover:text-slate-300" data-accordion-caret>
                            <svg viewBox="0 0 20 20" class="h-4 w-4" fill="none" stroke="currentColor"
                                stroke-width="1.8" stroke-linecap="round">
                                <path d="M6 8l4 4 4-4" />
                            </svg>
                        </span>
                    </button>

                    <ul id="analyticsMenu" class="mt-1 hidden space-y-1 pl-9" data-accordion-panel data-open="false">
                        <li>
                            <a href="#performance" class="block rounded-md px-3 py-2 text-sm text-slate-700 hover:bg-slate-50
                      dark:text-slate-200 dark:hover:bg-white/5">
                                Reports
                            </a>
                        </li>
                        <li>
                            <a href="#performance" class="block rounded-md px-3 py-2 text-sm text-slate-700 hover:bg-slate-50
                      dark:text-slate-200 dark:hover:bg-white/5">
                                Activity log
                            </a>
                        </li>
                    </ul>
                </div>

                <!-- Quick links -->
                <div class="space-y-1 pt-1">
                    <a href="#account" class="group flex items-center gap-3 rounded-md border border-transparent px-3 py-2 text-sm
                  text-slate-800 hover:border-slate-200 hover:bg-slate-50
                  dark:text-slate-100 dark:hover:bg-white/10 dark:hover:border-slate-700">
                        <span class="flex h-6 w-6 items-center justify-center rounded-full text-slate-500 group-hover:text-slate-700
                       dark:text-slate-400 dark:group-hover:text-slate-200">
                            <svg viewBox="0 0 24 24" class="h-4 w-4" fill="none" stroke="currentColor" stroke-width="2"
                                stroke-linecap="round" stroke-linejoin="round">
                                <circle cx="12" cy="8" r="3.5" />
                                <path d="M8.5 13 7 20l5-2 5 2-1.5-7" />
                            </svg>
                        </span>
                        <span>Exness benefits</span>
                    </a>

                    <a href="#trade" class="group flex items-center gap-3 rounded-md border border-transparent px-3 py-2 text-sm
                  text-slate-800 hover:border-slate-200 hover:bg-slate-50
                  dark:text-slate-100 dark:hover:bg-white/10 dark:hover:border-slate-700">
                        <span class="flex h-6 w-6 items-center justify-center rounded-full text-slate-500 group-hover:text-slate-700
                       dark:text-slate-400 dark:group-hover:text-slate-200">
                            <svg viewBox="0 0 24 24" class="h-4 w-4" fill="none" stroke="currentColor" stroke-width="2"
                                stroke-linecap="round" stroke-linejoin="round">
                                <circle cx="8" cy="8" r="3" />
                                <circle cx="16" cy="16" r="3" />
                                <path d="M11 9.5 13 11.5" />
                                <path d="M5 16v1a3 3 0 0 0 3 3h1" />
                                <path d="M13 5h1a3 3 0 0 1 3 3v1" />
                            </svg>
                        </span>
                        <span>Copy Trading</span>
                    </a>

                    <a href="#account" class="group flex items-center justify-between rounded-md border border-transparent px-3 py-2 text-sm
                  text-slate-800 hover:border-slate-200 hover:bg-slate-50
                  dark:text-slate-100 dark:hover:bg-white/10 dark:hover:border-slate-700">
                        <span class="flex items-center gap-3">
                            <span class="flex h-6 w-6 items-center justify-center rounded-full text-slate-500 group-hover:text-slate-700
                         dark:text-slate-400 dark:group-hover:text-slate-200">
                                <svg viewBox="0 0 24 24" class="h-4 w-4" fill="none" stroke="currentColor"
                                    stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <path
                                        d="M12 21s-5-3.3-8-6.6C1.5 12 2 8.5 4.5 7A4.1 4.1 0 0 1 12 8a4.1 4.1 0 0 1 7.5-1C22 8.5 22.5 12 20 14.4 17 17.7 12 21 12 21z" />
                                </svg>
                            </span>
                            <span>Support hub</span>
                        </span>
                        <span class="rounded-full bg-indigo-50 px-2.5 py-0.5 text-xs font-medium text-indigo-500
                       dark:bg-indigo-500/10 dark:text-indigo-300">
                            New
                        </span>
                    </a>

                    <!-- Settings submenu -->
                    <div class="space-y-1 pt-1">
                        <button type="button" class="group flex w-full items-center justify-between rounded-md border border-transparent px-3 py-2 text-sm font-medium
                         text-slate-800 hover:border-slate-200 hover:bg-slate-50
                         dark:text-slate-100 dark:hover:bg-white/10 dark:hover:border-slate-700" data-accordion-trigger
                            data-target="#settingsMenu" aria-expanded="false">
                            <span class="flex items-center gap-3">
                                <span class="flex h-6 w-6 items-center justify-center rounded-full text-slate-500 group-hover:text-slate-700
                           dark:text-slate-400 dark:group-hover:text-slate-200">
                                    <svg viewBox="0 0 24 24" class="h-4 w-4" fill="none" stroke="currentColor"
                                        stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                        <circle cx="12" cy="12" r="3" />
                                        <path
                                            d="M19.4 15a1.7 1.7 0 0 0 .3 1.8l.1.1a1.9 1.9 0 1 1-2.7 2.7l-.1-.1a1.7 1.7 0 0 0-1.8-.3A1.7 1.7 0 0 0 14 21v.2a1.9 1.9 0 0 1-3.8 0V21a1.7 1.7 0 0 0-1-1.5 1.7 1.7 0 0 0-1.8.3l-.1.1a1.9 1.9 0 1 1-2.7-2.7l.1-.1a1.7 1.7 0 0 0 .3-1.8A1.7 1.7 0 0 0 3.2 14H3a1.9 1.9 0 0 1 0-3.8h.2a1.7 1.7 0 0 0 1.5-1 1.7 1.7 0 0 0-.3-1.8l-.1-.1a1.9 1.9 0 1 1 2.7-2.7l.1.1a1.7 1.7 0 0 0 1.8.3H9a1.7 1.7 0 0 0 1-1.5V3a1.9 1.9 0 0 1 3.8 0v.2a1.7 1.7 0 0 0 1 1.5 1.7 1.7 0 0 0 1.8-.3l.1-.1a1.9 1.9 0 1 1 2.7 2.7l-.1.1a1.7 1.7 0 0 0-.3 1.8V9a1.7 1.7 0 0 0 1.5 1H21a1.9 1.9 0 0 1 0 3.8h-.2a1.7 1.7 0 0 0-1.4 1.2Z" />
                                    </svg>
                                </span>
                                <span>Settings</span>
                            </span>
                            <span
                                class="ml-2 text-slate-400 transition-transform duration-150 group-hover:text-slate-500 dark:text-slate-500 dark:group-hover:text-slate-300"
                                data-accordion-caret>
                                <svg viewBox="0 0 20 20" class="h-4 w-4" fill="none" stroke="currentColor"
                                    stroke-width="1.8" stroke-linecap="round">
                                    <path d="M6 8l4 4 4-4" />
                                </svg>
                            </span>
                        </button>

                        <ul id="settingsMenu" class="mt-1 hidden space-y-1 pl-9" data-accordion-panel data-open="false">
                            <li>
                                <a href="#account" class="block rounded-md px-3 py-2 text-sm text-slate-700 hover:bg-slate-50
                                       dark:text-slate-200 dark:hover:bg-white/5">
                                    Profile &amp; details
                                </a>
                            </li>
                            <li>
                                <a href="#account" class="block rounded-md px-3 py-2 text-sm text-slate-700 hover:bg-slate-50
                                       dark:text-slate-200 dark:hover:bg-white/5">
                                    Security &amp; login
                                </a>
                            </li>
                        </ul>
                    </div>
                </div>

                <!-- Bottom actions -->
                <div class="mt-auto border-t border-slate-200 pt-4 dark:border-slate-800">
                    <!-- Language dropdown -->
                    <div class="relative mb-3" data-dropdown-root>
                        <button type="button" data-dropdown-btn="sidebar-language" class="flex w-full items-center justify-between rounded-md border border-slate-200 bg-white px-3 py-2 text-xs font-medium
                         text-slate-700 hover:bg-slate-50
                         dark:border-slate-700 dark:bg-black dark:text-slate-200 dark:hover:bg-slate-900">
                            <span class="flex items-center gap-2">
                                <span
                                    class="flex h-5 w-5 items-center justify-center text-slate-500 dark:text-slate-400">
                                    <svg viewBox="0 0 24 24" class="h-4 w-4" fill="none" stroke="currentColor"
                                        stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round">
                                        <circle cx="12" cy="12" r="9" />
                                        <path d="M3 12h18" />
                                        <path d="M12 3a15 15 0 0 1 0 18" />
                                        <path d="M12 3a15 15 0 0 0 0 18" />
                                    </svg>
                                </span>
                                <span>English</span>
                            </span>
                            <span class="text-slate-400 dark:text-slate-500">
                                <svg viewBox="0 0 20 20" class="h-4 w-4" fill="none" stroke="currentColor"
                                    stroke-width="1.8" stroke-linecap="round">
                                    <path d="M6 8l4 4 4-4" />
                                </svg>
                            </span>
                        </button>

                        <div data-dropdown-panel="sidebar-language" class="hidden absolute bottom-10 left-0 z-20 w-full rounded-md border border-slate-200 bg-white text-xs shadow-lg
                      dark:border-slate-700 dark:bg-slate-950">
                            <ul class="py-1">
                                <li><button
                                        class="flex w-full items-center px-3 py-1.5 text-left text-slate-700 hover:bg-slate-50 dark:text-slate-200 dark:hover:bg-slate-900">English</button>
                                </li>
                                <li><button
                                        class="flex w-full items-center px-3 py-1.5 text-left text-slate-700 hover:bg-slate-50 dark:text-slate-200 dark:hover:bg-slate-900">Français</button>
                                </li>
                                <li><button
                                        class="flex w-full items-center px-3 py-1.5 text-left text-slate-700 hover:bg-slate-50 dark:text-slate-200 dark:hover:bg-slate-900">Español</button>
                                </li>
                                <li><button
                                        class="flex w-full items-center px-3 py-1.5 text-left text-slate-700 hover:bg-slate-50 dark:text-slate-200 dark:hover:bg-slate-900">Deutsch</button>
                                </li>
                                <li><button
                                        class="flex w-full items-center px-3 py-1.5 text-left text-slate-700 hover:bg-slate-50 dark:text-slate-200 dark:hover:bg-slate-900">Português</button>
                                </li>
                                <li><button
                                        class="flex w-full items-center px-3 py-1.5 text-left text-slate-700 hover:bg-slate-50 dark:text-slate-200 dark:hover:bg-slate-900">العربية</button>
                                </li>
                            </ul>
                        </div>
                    </div>

                    <!-- Need help -->
                    <button type="button" class="mb-3 flex w-full items-center gap-2 rounded-md border border-slate-200 bg-white px-3 py-2 text-xs font-medium
                       text-slate-700 hover:bg-slate-50
                       dark:border-slate-700 dark:bg-black dark:text-slate-200 dark:hover:bg-slate-900">
                        <span class="flex h-5 w-5 items-center justify-center text-slate-500 dark:text-slate-400">
                            <svg viewBox="0 0 24 24" class="h-4 w-4" fill="none" stroke="currentColor"
                                stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M12 21a9 9 0 1 0-9-9" />
                                <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 2-3 4" />
                                <circle cx="12" cy="17" r="0.7" />
                            </svg>
                        </span>
                        <span>Need help</span>
                    </button>

                    <!-- Logout -->
                    <button type="button" class="flex w-full items-center justify-center gap-2 rounded-md border border-red-500/40 bg-red-500/10 px-3 py-2 text-xs font-medium
                       text-red-600 hover:bg-red-500/15
                       dark:border-red-500/60 dark:bg-red-500/10 dark:text-red-300 dark:hover:bg-red-500/20">
                        <span class="flex h-5 w-5 items-center justify-center">
                            <svg viewBox="0 0 24 24" class="h-4 w-4" fill="none" stroke="currentColor"
                                stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M15 3h-4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h4" />
                                <path d="M10 12h10" />
                                <path d="M17 9l3 3-3 3" />
                            </svg>
                        </span>
                        <span>Log out</span>
                    </button>
                </div>
            </nav>
        </aside>

        <!-- BACKDROP FOR MOBILE SIDEBAR -->
        <div id="sidebarBackdrop"
            class="fixed inset-x-0 top-16 bottom-0 z-30 bg-black/40 opacity-0 pointer-events-none transition-opacity duration-200 md:hidden">
        </div>

        <!-- MAIN CONTENT -->
        <main class="flex-1 overflow-y-auto bg-slate-50 p-4 pb-20 md:p-8 md:pb-8 dark:bg-black">
            @RenderBody()
        </main>

    </div>

    <!-- ===================== BOTTOM NAV (MOBILE) ===================== -->
    <nav
        class="fixed bottom-0 left-0 right-0 z-30 border-t border-slate-200 bg-white/95 backdrop-blur dark:border-slate-800 dark:bg-black md:hidden">
        <div class="mx-auto flex max-w-lg items-center justify-between px-4 py-2">

            <button
                class="flex flex-1 flex-col items-center gap-1 text-[11px] font-medium text-slate-900 dark:text-slate-50"
                data-nav-target="account">
                <svg viewBox="0 0 24 24" class="h-5 w-5" fill="none" stroke="currentColor" stroke-width="1.8"
                    stroke-linecap="round" stroke-linejoin="round">
                    <circle cx="12" cy="8" r="3.2" />
                    <path d="M5 19a7 7 0 0 1 14 0" />
                </svg>
                <span>Account</span>
            </button>

            <button
                class="flex flex-1 flex-col items-center gap-1 text-[11px] font-medium text-slate-500 hover:text-slate-900 dark:text-slate-400 dark:hover:text-slate-50"
                data-nav-target="trade">
                <svg viewBox="0 0 24 24" class="h-5 w-5" fill="none" stroke="currentColor" stroke-width="1.8"
                    stroke-linecap="round" stroke-linejoin="round">
                    <path d="M6 4v16M6 8h4v8H6z" />
                    <path d="M18 4v16M14 10h4v4h-4z" />
                </svg>
                <span>Trade</span>
            </button>

            <button
                class="flex flex-1 flex-col items-center gap-1 text-[11px] font-medium text-slate-500 hover:text-slate-900 dark:text-slate-400 dark:hover:text-slate-50"
                data-nav-target="market">
                <svg viewBox="0 0 24 24" class="h-5 w-5" fill="none" stroke="currentColor" stroke-width="1.8"
                    stroke-linecap="round" stroke-linejoin="round">
                    <rect x="3" y="12" width="3" height="8" rx="1" />
                    <rect x="10.5" y="8" width="3" height="12" rx="1" />
                    <rect x="18" y="4" width="3" height="16" rx="1" />
                </svg>
                <span>Market</span>
            </button>

            <button
                class="flex flex-1 flex-col items-center gap-1 text-[11px] font-medium text-slate-500 hover:text-slate-900 dark:text-slate-400 dark:hover:text-slate-50"
                data-nav-target="performance">
                <svg viewBox="0 0 24 24" class="h-5 w-5" fill="none" stroke="currentColor" stroke-width="1.8"
                    stroke-linecap="round" stroke-linejoin="round">
                    <path d="M4 18 9.5 12.5 13 16l5-6" />
                    <path d="M4 6h16" />
                </svg>
                <span>Performance</span>
            </button>

            <button id="sidebarToggle"
                class="flex flex-1 flex-col items-center gap-1 text-[11px] font-medium text-slate-600 hover:text-slate-900 dark:text-slate-300 dark:hover:text-slate-50">
                <svg viewBox="0 0 24 24" class="h-5 w-5" fill="none" stroke="currentColor" stroke-width="1.8"
                    stroke-linecap="round" stroke-linejoin="round">
                    <circle cx="12" cy="5" r="1.4" />
                    <circle cx="12" cy="12" r="1.4" />
                    <circle cx="12" cy="19" r="1.4" />
                </svg>
                <span>More</span>
            </button>

        </div>
    </nav>

    <!-- ===================== SCRIPTS ===================== -->
    <script>
        // Sidebar slide-in (mobile) + backdrop + navbar close button toggle
        const sidebar = document.getElementById("sidebar");
        const sidebarBackdrop = document.getElementById("sidebarBackdrop");
        const sidebarToggle = document.getElementById("sidebarToggle"); // bottom nav "More"
        const sidebarClose = document.getElementById("sidebarClose");   // X button in TOP NAV (left)

        function showCloseBtn() {
            if (!sidebarClose) return;
            sidebarClose.classList.remove("hidden");
            sidebarClose.classList.add("inline-flex");
        }

        function hideCloseBtn() {
            if (!sidebarClose) return;
            sidebarClose.classList.add("hidden");
            sidebarClose.classList.remove("inline-flex");
        }

        function openSidebar() {
            if (!sidebar) return;

            sidebar.classList.remove("-translate-x-full");
            sidebar.classList.add("translate-x-0");

            if (sidebarBackdrop) {
                sidebarBackdrop.classList.remove("opacity-0", "pointer-events-none");
                sidebarBackdrop.classList.add("opacity-100", "pointer-events-auto");
            }

            if (window.innerWidth < 768) showCloseBtn();
        }

        function closeSidebar() {
            if (!sidebar) return;

            sidebar.classList.add("-translate-x-full");
            sidebar.classList.remove("translate-x-0");

            if (sidebarBackdrop) {
                sidebarBackdrop.classList.add("opacity-0", "pointer-events-none");
                sidebarBackdrop.classList.remove("opacity-100", "pointer-events-auto");
            }

            hideCloseBtn();
        }

        function toggleSidebar() {
            if (!sidebar) return;
            if (sidebar.classList.contains("-translate-x-full")) openSidebar();
            else closeSidebar();
        }

        sidebarToggle?.addEventListener("click", (e) => { e.stopPropagation(); toggleSidebar(); });
        sidebarClose?.addEventListener("click", (e) => { e.stopPropagation(); closeSidebar(); });
        sidebarBackdrop?.addEventListener("click", () => closeSidebar());

        // Ensure correct state on resize
        window.addEventListener("resize", () => {
            if (window.innerWidth >= 768) {
                hideCloseBtn();
                sidebar?.classList.remove("-translate-x-full");
                sidebar?.classList.add("translate-x-0");
                sidebarBackdrop?.classList.add("opacity-0", "pointer-events-none");
                sidebarBackdrop?.classList.remove("opacity-100", "pointer-events-auto");
            } else {
                closeSidebar();
            }
        });

        // Dark mode toggle
        document.getElementById("modeToggle")?.addEventListener("click", () => {
            const root = document.documentElement;
            const isDark = root.classList.toggle("dark");
            localStorage.setItem("theme", isDark ? "dark" : "light");
        });

        // Accordion (sidebar groups)
        document.querySelectorAll("[data-accordion-trigger]").forEach(btn => {
            btn.addEventListener("click", () => {
                const targetSel = btn.getAttribute("data-target");
                const panel = document.querySelector(targetSel);
                if (!panel) return;

                const isOpen = panel.dataset.open === "true";
                panel.dataset.open = String(!isOpen);
                panel.classList.toggle("hidden", isOpen);

                const caret = btn.querySelector("[data-accordion-caret]");
                if (caret) caret.classList.toggle("-rotate-180", !isOpen);
            });
        });

        // Dropdowns (navbar + sidebar language)
        const closeAllDropdowns = () => {
            document.querySelectorAll("[data-dropdown-panel]").forEach(p => p.classList.add("hidden"));
        };

        document.querySelectorAll("[data-dropdown-btn]").forEach(btn => {
            btn.addEventListener("click", (e) => {
                e.stopPropagation();
                const key = btn.getAttribute("data-dropdown-btn");
                const panel = document.querySelector(`[data-dropdown-panel="${key}"]`);
                if (!panel) return;

                const isHidden = panel.classList.contains("hidden");
                closeAllDropdowns();
                if (isHidden) panel.classList.remove("hidden");
            });
        });

        document.addEventListener("click", (e) => {
            const rootMatch = (el) => el.closest && el.closest("[data-dropdown-root]");
            if (!rootMatch(e.target)) closeAllDropdowns();
        });

        // Bottom nav: active state + scroll-to sections in content (optional)
        const bottomNavButtons = document.querySelectorAll("[data-nav-target]");

        function setActiveNav(targetId) {
            bottomNavButtons.forEach(btn => {
                const id = btn.getAttribute("data-nav-target");
                if (id === targetId) {
                    btn.classList.remove("text-slate-500", "dark:text-slate-400");
                    btn.classList.add("text-slate-900", "dark:text-slate-50");
                } else {
                    btn.classList.remove("text-slate-900", "dark:text-slate-50");
                    btn.classList.add("text-slate-500", "dark:text-slate-400");
                }
            });
        }

        bottomNavButtons.forEach(btn => {
            btn.addEventListener("click", () => {
                const targetId = btn.getAttribute("data-nav-target");
                if (!targetId) return;

                // If your page contains sections with these IDs, smooth-scroll to them.
                const section = document.getElementById(targetId);
                if (section) section.scrollIntoView({ behavior: "smooth", block: "start" });

                setActiveNav(targetId);
                closeSidebar();
            });
        });

        setActiveNav("account");
        hideCloseBtn(); // start hidden
    </script>

    @RenderSection("Scripts", required: false)
</body>

</html>